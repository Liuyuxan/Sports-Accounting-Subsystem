import{t as Y}from"./team-project-5117a1b6.js";import{t as z}from"./type-21adf978.js";import{_ as X,r as G,u as H,s as J,a as K,t as M,b as f,o as p,c as h,d as o,w as s,e as d,f as a,v,F as w,g as x,h as D,i as g,j as R,p as Q,k as W}from"./index-8a367a98.js";import{Y as T}from"./index-992b3621.js";import{u as Z}from"./infos-ff935eca.js";const k=I=>(Q("data-v-14ff321e"),I=I(),W(),I),ee={class:"team title-center center"},te=k(()=>d("h2",{class:"project-title"},"团队项目成绩提交",-1)),oe={class:"project top"},se=k(()=>d("h2",{class:"name"},"选择信息",-1)),le={class:"project-inner"},ae={class:"info top"},ne=k(()=>d("div",{class:"info-title"},[d("h2",{class:"name"},"填写信息")],-1)),ce={class:"submit"},ue={__name:"team",setup(I){G(1);const j=H(),S=Z(),{teamInfos:O}=J(S);let C=!0;const n=K({sportId:"",status:"",matchType:"",infos:[{sportId:"",status:"",matchType:"",id:"",department:"",name:"",scores:""}]}),c=M(n);let V=0;const $=()=>{n.infos[0].sportId=c.sportId.value,console.log("项目已选择"),F()},N=()=>{n.infos[0].status=c.status.value,console.log("身份已选择"),F()},F=()=>{if(V!==2&&V++,V===2){console.log("全部选择完成");const e=c.sportId.value;c.matchType.value;const l=c.status.value;S.fetchTeamInfosData(e,1,l).then(r=>{n.infos=O.value.infos})}},q=e=>{console.log("删除前：",n.infos),console.log("index:",e);const l=n.infos[e].teamId,r=n.infos[e].sportId,i=n.infos[e].classify;console.log("删除了: ",l,r,i),T.delete({url:`/Team/deleteId/${l}/${r}/${i}`}).then(u=>{console.log(u),n.infos.splice(e,1),console.log("删除了一条信息,所剩信息：",n.infos)}).catch(u=>{console.log(u)})},_=[];let B=[];async function A(){console.log("formData.infos:",n.infos);for(const e of _)B.push(e);for(const e of n.infos)console.log(e.scores),e.scores&&_.push(e);console.log("提交的数组：",_),E(_,B),T.post({url:"/SportInfo/submit/down",data:_}).then(e=>{if(console.log(e),e.code==0){const l=e.msg.slice(10);alert(`团队编号：${l} 错误，请仔细检查一下团队编号：${l} 有没有输入错误哦~`);return}alert("提交成功"),j.go(0)}).catch(e=>{console.log(e)})}const E=(e,l)=>e.concat(l).filter(function(r,i,u){return u.indexOf(r)===u.lastIndexOf(r)});return(e,l)=>{const r=f("Option"),i=f("Select"),u=f("Input"),y=f("Col"),U=f("Button"),L=f("Row"),P=f("Form");return p(),h("div",ee,[te,o(P,{ref:"formData",model:n.value,"label-width":80,style:{width:"1000px"}},{default:s(()=>[d("div",oe,[se,d("div",le,[o(a(v.FormItem),{label:"项目"},{default:s(()=>[o(i,{modelValue:a(c).sportId.value,"onUpdate:modelValue":l[0]||(l[0]=t=>a(c).sportId.value=t),onOnChange:$,style:{width:"420px"}},{default:s(()=>[(p(!0),h(w,null,x(a(Y).sportList,t=>(p(),D(r,{value:t.value,key:t.value},{default:s(()=>[g(R(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(a(v.FormItem),{label:"身份"},{default:s(()=>[o(i,{modelValue:a(c).status.value,"onUpdate:modelValue":l[1]||(l[1]=t=>a(c).status.value=t),onOnChange:N,style:{width:"420px"}},{default:s(()=>[(p(!0),h(w,null,x(a(z).status,t=>(p(),D(r,{value:t.value,key:t.value},{default:s(()=>[g(R(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),d("div",ae,[ne,(p(!0),h(w,null,x(a(c).infos.value,(t,b)=>(p(),h("div",{key:b,class:"content"},[o(L,null,{default:s(()=>[o(y,null,{default:s(()=>[o(a(v.FormItem),{label:"团队编号"+Number(b+1)},{default:s(()=>[o(u,{modelValue:t.id,"onUpdate:modelValue":m=>t.id=m,placeholder:"学号",style:{width:"250px"},readonly:a(C)},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1032,["label"])]),_:2},1024),o(y,null,{default:s(()=>[o(a(v.FormItem),{label:"团队:"},{default:s(()=>[o(u,{modelValue:t.department,"onUpdate:modelValue":m=>t.department=m,placeholder:"学院\\团队",style:{width:"250px"},readonly:a(C)},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024)]),_:2},1024),o(y,null,{default:s(()=>[o(a(v.FormItem),{label:"成绩:"},{default:s(()=>[o(u,{modelValue:t.scores,"onUpdate:modelValue":m=>t.scores=m,placeholder:"成绩",style:{width:"210px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(y,null,{default:s(()=>[o(U,{class:"deleteBtn",onClick:m=>q(b),size:"small"},{default:s(()=>[g("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),d("div",ce,[o(U,{type:"primary",class:"btn",onClick:A,style:{width:"100px"}},{default:s(()=>[g("提交")]),_:1})])]),_:1},8,["model"])])}}},me=X(ue,[["__scopeId","data-v-14ff321e"]]);export{me as default};
