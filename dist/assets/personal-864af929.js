import{p as R}from"./personal-project-bcac765b.js";import{t as j}from"./type-21adf978.js";import{_ as z,r as A,u as X,s as H,a as J,t as K,b as m,o as d,c as _,d as o,w as l,e as f,f as t,v as i,F as g,g as I,h as T,i as h,j as k,p as Q,k as W}from"./index-8a367a98.js";import{Y as $}from"./index-992b3621.js";import{u as Z}from"./infos-ff935eca.js";const C=b=>(Q("data-v-72695b02"),b=b(),W(),b),ee={class:"personal title-center center"},oe=C(()=>f("h2",{class:"project-title"},"个人项目成绩提交",-1)),le={class:"project top"},te=C(()=>f("h2",{class:"name"},"选择信息",-1)),se={class:"project-inner"},ae={class:"info top"},ne=C(()=>f("div",{class:"info-title"},[f("h2",{class:"name"},"填写信息")],-1)),ue={class:"submit"},de={__name:"personal",setup(b){A(1);const D=X(),B=Z(),{sportsManInfos:N}=H(B);let x=!0;const s=J({sportId:"",status:"",matchType:"",infos:[{sportId:"",status:"",matchType:"",id:"",numbers:"",department:"",name:"",scores:""}]}),n=K(s);let F=0;const L=()=>{s.infos[0].sportId=n.sportId.value,console.log("项目已选择"),S()},M=()=>{s.infos[0].status=n.status.value,console.log("身份已选择"),S()},q=()=>{s.infos[0].matchType=n.matchType.value,console.log(n.matchType.value),console.log("赛区已选择"),S()},S=()=>{if(F!==3&&F++,F===3){console.log("全部选择完成");const a=n.sportId.value,u=n.matchType.value,c=n.status.value;B.fetchSportsManInfosData(a,u,c).then(v=>{s.infos=N.value.infos,console.log(typeof s.infos);for(const r of s.infos)r.id=r.numbers})}},E=a=>{console.log("删除前：",s.infos),console.log("index:",a);const u=s.infos[a].id,c=s.infos[a].sportId,v=s.infos[a].classify;console.log("删除了: ",u,c,v),$.delete({url:`/Athlete/deleteId/${u}/${c}/${v}`}).then(r=>{console.log(r),s.infos.splice(a,1),console.log("删除了一条信息,所剩信息：",s.infos)}).catch(r=>{console.log(r)})},V=[],G=()=>{console.log(s),console.log("已提交");for(const a of s.infos)a.scores&&V.push(a);console.log("提交的数组：",V),console.log("原数组：",s),$.post({url:"/SportInfo/submit/down",data:V}).then(a=>{if(console.log(a),a.code==0){const u=a.msg.slice(13);V.length=0,alert(`学号：${u} 错误，请仔细检查一下学号：${u} 有没有输入错误哦~`);return}alert("提交成功"),D.go(0)})};return(a,u)=>{const c=m("Option"),v=m("OptionGroup"),r=m("Select"),w=m("Input"),y=m("Col"),O=m("Button"),P=m("Row"),Y=m("Form");return d(),_("div",ee,[oe,o(Y,{ref:"formData",model:s.value,"label-width":50,style:{width:"1000px"}},{default:l(()=>[f("div",le,[te,f("div",se,[o(t(i.FormItem),{label:"项目"},{default:l(()=>[o(r,{modelValue:t(n).sportId.value,"onUpdate:modelValue":u[0]||(u[0]=e=>t(n).sportId.value=e),onOnChange:L,style:{width:"450px"}},{default:l(()=>[o(v,{label:"径赛"},{default:l(()=>[(d(!0),_(g,null,I(t(R).sportList1,e=>(d(),T(c,{value:e.value,key:e.value},{default:l(()=>[h(k(e.label),1)]),_:2},1032,["value"]))),128))]),_:1}),o(v,{label:"田赛"},{default:l(()=>[(d(!0),_(g,null,I(t(R).sportList2,e=>(d(),T(c,{value:e.value,key:e.value},{default:l(()=>[h(k(e.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(t(i.FormItem),{label:"身份"},{default:l(()=>[o(r,{modelValue:t(n).status.value,"onUpdate:modelValue":u[1]||(u[1]=e=>t(n).status.value=e),onOnChange:M,style:{width:"200px"}},{default:l(()=>[(d(!0),_(g,null,I(t(j).status,e=>(d(),T(c,{value:e.value,key:e.value},{default:l(()=>[h(k(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(t(i.FormItem),{label:"赛区"},{default:l(()=>[o(r,{modelValue:t(n).matchType.value,"onUpdate:modelValue":u[2]||(u[2]=e=>t(n).matchType.value=e),onOnChange:q,style:{width:"200px"}},{default:l(()=>[(d(!0),_(g,null,I(t(j).matchType,e=>(d(),T(c,{value:e.value,key:e.value},{default:l(()=>[h(k(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),f("div",ae,[ne,(d(!0),_(g,null,I(t(n).infos.value,(e,U)=>(d(),_("div",{key:U,class:"content"},[o(P,null,{default:l(()=>[o(y,null,{default:l(()=>[o(t(i.FormItem),{label:"学号"+Number(U+1)},{default:l(()=>[o(w,{modelValue:e.numbers,"onUpdate:modelValue":p=>e.numbers=p,placeholder:"学号/工号",style:{width:"200px"},readonly:t(x)},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1032,["label"])]),_:2},1024),o(y,null,{default:l(()=>[o(t(i.FormItem),{label:"学院:"},{default:l(()=>[o(w,{modelValue:e.department,"onUpdate:modelValue":p=>e.department=p,placeholder:"学院/团队",style:{width:"200px"},readonly:t(x)},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024)]),_:2},1024),o(y,null,{default:l(()=>[o(t(i.FormItem),{label:"姓名:"},{default:l(()=>[o(w,{modelValue:e.name,"onUpdate:modelValue":p=>e.name=p,placeholder:"姓名",style:{width:"200px"},readonly:t(x)},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024)]),_:2},1024),o(y,null,{default:l(()=>[o(t(i.FormItem),{label:"成绩:"},{default:l(()=>[o(w,{modelValue:e.scores,"onUpdate:modelValue":p=>e.scores=p,placeholder:"成绩",style:{width:"150px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),o(y,null,{default:l(()=>[o(O,{class:"deleteBtn",onClick:p=>E(U),size:"small"},{default:l(()=>[h("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),f("div",ue,[o(O,{type:"primary",class:"btn",onClick:G,style:{width:"100px"}},{default:l(()=>[h("提交")]),_:1})])]),_:1},8,["model"])])}}},_e=z(de,[["__scopeId","data-v-72695b02"]]);export{_e as default};
